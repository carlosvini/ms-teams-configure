<html>
  <head>
    <script src="https://statics.teams.cdn.office.net/sdk/v1.6.0/js/MicrosoftTeams.min.js"></script>
  </head>
  <body>
    v4
    <div id="gray" style="display:none">Gray</div>
    <div id="red" style="display:none">Red</div>
    <button
      onclick="colorClickGray()"
    >
      Select Gray
    </button>
    <button
      onclick="colorClickRed()"
    >
      Select Red
    </button>

    <script>
      
      microsoftTeams.initialize();
      let saveGray = () => {
        try {
        microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
          microsoftTeams.settings.setSettings({
            websiteUrl: "https://yourWebsite.com",
            contentUrl: "https://yourWebsite.com/gray",
            entityId: "grayIconTab",
            suggestedDisplayName: "MyNewTab",
          });
          saveEvent.notifySuccess();
          
          const response = microsoftTeams.settings.getSettings();
          alert(JSON.stringify(response)
        });
                 
    } catch (err) {
      alert(err.message)
    }
      };
      let saveRed = () => {
         try {
        microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
          microsoftTeams.settings.setSettings({
            websiteUrl: "https://yourWebsite.com",
            contentUrl: "https://yourWebsite.com/red",
            entityId: "redIconTab",
            suggestedDisplayName: "MyNewTab",
          });
          saveEvent.notifySuccess();
          
          const response = microsoftTeams.settings.getSettings();
          alert(JSON.stringify(response)
        });
    } catch (err) {
      alert(err.message)
    }
      };

      let gr = document.getElementById("gray").style;
      let rd = document.getElementById("red").style;
 
        
      const colorClickGray = () => {
        gr.display = "block";
        rd.display = "none";
        microsoftTeams.settings.setValidityState(true);
        saveGray();
      };

      const colorClickRed = () => {
        rd.display = "block";
        gr.display = "none";
        microsoftTeams.settings.setValidityState(true);
        saveRed();
      };
    </script>
  </body>
</html>
